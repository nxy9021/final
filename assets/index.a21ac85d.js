import"./vendor.0dd1e043.js";!function(t=".",s="__import__"){try{self[s]=new Function("u","return import(u)")}catch(e){const i=new URL(t,location),a=t=>{URL.revokeObjectURL(t.src),t.remove()};self[s]=t=>new Promise(((e,o)=>{const n=new URL(t,i);if(self[s].moduleMap[n])return e(self[s].moduleMap[n]);const r=new Blob([`import * as m from '${n}';`,`${s}.moduleMap['${n}']=m;`],{type:"text/javascript"}),c=Object.assign(document.createElement("script"),{type:"module",src:URL.createObjectURL(r),onerror(){o(new Error(`Failed to import: ${t}`)),a(c)},onload(){e(self[s].moduleMap[n]),a(c)}});document.head.appendChild(c)})),self[s].moduleMap={}}}("assets/");const t={boy1:"boy1",boy2:"boy2",girl1:"girl1",girl2:"girl2",girl3:"girl3",girl4:"girl4"},s={default:{name:"default",cursor:"assets/img/cursors/cdefault.png",button:"",color:0,x:0,y:0},question:{name:"question",cursor:"assets/img/cursors/cyellow.png",button:"assets/img/bubbles/byellow.png",color:16251904,x:325,y:570},food:{name:"food",cursor:"assets/img/cursors/cred.png",button:"assets/img/bubbles/bred.png",color:16734810,x:475,y:570},dots:{name:"dots",cursor:"assets/img/cursors/cblue.png",button:"assets/img/bubbles/bblue.png",color:49919,x:175,y:570},wakeup:{name:"wakeup",cursor:"assets/img/cursors/cgreen.png",button:"assets/img/bubbles/bgreen.png",color:60040,x:625,y:570}};class e extends Phaser.Scene{constructor(){super("preloader")}preload(){this.load.image("ref","assets/img/lvl1layout.png"),this.load.image("bgBeige","assets/img/solidbg/bg_beige.png"),this.load.image("heatBg","assets/img/heatgauge_bg.png"),this.load.image("heatImg","assets/img/heatgauge.png");for(const[,t]of Object.entries(s)){const s=t.name.toLowerCase();this.load.animation(s,`assets/img/distractions/${s}.json`),this.load.atlas(s,`assets/img/distractions/${s}.png`,`assets/img/distractions/${s}.json`)}for(const[,s]of Object.entries(t))this.load.image(s,`assets/img/charactors/${s}.png`);for(const[,t]of Object.entries(s))"default"!==t.name&&this.load.image(`${t.name}Button`,t.button)}create(){this.scene.start("lvl1")}}function i(t,s,e){t.create({key:s,frames:e,frameRate:24,repeat:-1})}var a,o;(o=a||(a={})).Default="default",o.Question="question",o.Food="food",o.Dots="dots",o.Wakeup="wakeup";class n{constructor(t,e,o,n,r){this._distractionType=a.Default,this._backgroundVerticalOffset=10,this.isDistracted=()=>this._distractionType!==a.Default,this.clickHandler=()=>{this._scene.events.emit("distractionClick",{name:this._name,distractionType:this._distractionType})},this.setDistraction=(t,s)=>{this._distractionType=t,this.startTimer(s),this._updateDistractionVisuals()},this.reset=()=>{this._distractionType=a.Default,this.startTimer(0),this._updateDistractionVisuals()},this.startTimer=t=>{this._countdown=this._scene.time.addEvent({delay:t})},this._updateDistractionVisuals=()=>{this._sprite.setTexture(this._distractionType),this._sprite.play(`${this._distractionType}Animation`),this._distractionType==a.Default?this._background.clearTint():this._background.setTint(s[this._distractionType].color)},this._scene=t,this._name=n;for(const[,a]of Object.entries(s)){const s=`${a.name}Animation`,e=t.textures.get(a.name).getFrameNames().sort().map((t=>({key:a.name,frame:t})));i(t.anims,s,e)}this._background=this._scene.add.image(e,o-this._backgroundVerticalOffset,"bgBeige").setScale(.6,.6),this._sprite=t.add.sprite(e,o,a.Default),this._topLeft=this._background.getTopLeft(),this._topRight=this._background.getTopRight(),this._width=this._topRight.x-this._topLeft.x,this._countDownBar=this._scene.add.rectangle(this._topLeft.x,this._topLeft.y+6,0,12,25599),this._updateDistractionVisuals(),this._background.setInteractive().on("pointerdown",this.clickHandler,this._scene),this._character=this._scene.add.image(e,o+3.5,r).setScale(.6,.6)}update(){if(null!=this._countdown){let t=this._countdown.getProgress();this._countDownBar.width=this._width-this._width*t,this._countDownBar.isFilled=!0,1==t&&this.reset()}}}class r extends Phaser.Scene{constructor(){super("lvl1"),this.distractionTiles={l1c1:n,l1c2:n,l1c3:n,l2c1:n,l2c2:n,l2c3:n},this.barTimerEvents=[],this.currentClickedDistraction=a.Default,this.comboCount=0,this.gpa="0.00",this.earnedPoints=0,this.successCount=0,this.heatLevel=0,this.totalSpawnedDistractions=0,this.totalPossibleScore=0,this.allowedDistractionTypes=[],this.updateGpa=()=>{0===this.earnedPoints?this.gpa="0.00":this.gpa=(this.earnedPoints/this.totalPossibleScore*4).toFixed(2),this.gpaText.setText(`GPA: ${this.gpa}`)},this.setHeatLevel=()=>{this.comboCount<=2?this.heatLevel=1:this.comboCount<=5?this.heatLevel=2:this.comboCount<=8?this.heatLevel=3:this.comboCount<=10?this.heatLevel=4:this.heatLevel=5},this.incrementTotalPossibleScore=()=>{this.totalSpawnedDistractions<=2?this.totalPossibleScore++:this.totalSpawnedDistractions<=5?this.totalPossibleScore+=2:this.totalSpawnedDistractions<=8?this.totalPossibleScore+=3:this.totalSpawnedDistractions<=10?this.totalPossibleScore+=4:this.totalPossibleScore+=5},this.getNonDistractedTileNames=()=>{const t=[];for(const s of Object.keys(this.distractionTiles))this.distractionTiles[s].isDistracted()||t.push(s);return t},this.getRandomAllowedDistractionType=()=>{const t=Phaser.Math.Between(0,this.allowedDistractionTypes.length-1);return this.allowedDistractionTypes[t]},this.handleDistractionSpawning=()=>{const t=this.getNonDistractedTileNames(),s=Object.keys(this.distractionTiles).length-t.length,e=this.mainTimer.getRemaining()>this.countdownInterval;if(s<this.maximumActiveDistractions&&e){const s=t[Phaser.Math.Between(0,t.length-1)];this.distractionTiles[s].setDistraction(this.getRandomAllowedDistractionType(),this.countdownInterval),this.totalSpawnedDistractions++,this.incrementTotalPossibleScore()}if(e){const t=Phaser.Math.Between(this.spawnIntervalRange.minimum,this.spawnIntervalRange.maximum);this.setSpawnTimer(t)}},this.setSpawnTimer=t=>{this.spawnTimer=this.time.delayedCall(t,this.handleDistractionSpawning,[],this)},this.setupDistractionButton=(t,e,i)=>{let a=s[t],o=this.add.sprite(e,i,`${t}Button`);o.setInteractive({cursor:`url(${a.cursor}), pointer`}),o.on("pointerdown",(()=>{o.setTint(a.color),this.input.setDefaultCursor(`url(${a.cursor}), pointer`),this.currentClickedDistraction=t}))},this.generateDistractionButtons=()=>{for(const[,t]of Object.entries(s))this.allowedDistractionTypes.includes(t.name)&&this.setupDistractionButton(t.name,t.x,t.y)},this.updateRemainingTime=()=>{const t=this.mainTimer.getRemainingSeconds().toFixed(2),s=t.indexOf("."),e=t.substring(s+1);let i=t.substring(0,s);i.length<2&&(i=`0${i}`),this.text.setText(`Time: ${i}:${e}`)},this.updateTiles=()=>{Object.keys(this.distractionTiles).forEach((t=>this.distractionTiles[t].update()))},this.allowedDistractionTypes.push(a.Dots),this.maximumActiveDistractions=3,this.countdownInterval=5e3,this.spawnIntervalRange={minimum:500,maximum:2e3}}handleDistractionButtonOnClick(t){this.currentClickedDistraction!==a.Default&&t.distractionType==this.currentClickedDistraction?(this.comboCount++,this.setHeatLevel(),this.successCount++,this.earnedPoints+=this.heatLevel,this.distractionTiles[t.name].reset()):this.comboCount=0,this.currentClickedDistraction=a.Default,this.input.setDefaultCursor(`url(${s.default.cursor}), pointer`)}onGameTimeOver(){}create(){this.add.image(460,320,"heatBg"),this.distractionTiles.l1c1=new n(this,150,196,"l1c1",t.boy1),this.distractionTiles.l1c2=new n(this,400,196,"l1c2",t.boy2),this.distractionTiles.l1c3=new n(this,650,196,"l1c3",t.girl1),this.distractionTiles.l2c1=new n(this,150,410,"l2c1",t.girl2),this.distractionTiles.l2c2=new n(this,400,410,"l2c2",t.girl3),this.distractionTiles.l2c3=new n(this,650,410,"l2c3",t.girl4),this.generateDistractionButtons(),this.setSpawnTimer(3e3),this.events.on("distractionClick",(t=>this.handleDistractionButtonOnClick(t))),this.input.setDefaultCursor("url(assets/img/cursors/cdefault.png), pointer"),this.text=this.add.text(40,40,"",{fontFamily:"Roboto"}).setFontSize(20),this.mainTimer=this.time.delayedCall(45e3,this.onGameTimeOver,[],this),this.gpaText=this.add.text(640,40,"",{fontFamily:"Roboto"}).setFontSize(20)}update(){this.updateRemainingTime(),this.updateGpa(),this.updateTiles()}}const c={type:Phaser.AUTO,width:900,height:640,scene:[e,r]};new Phaser.Game(c);
